<UserControl x:Class="RestaurantApp.Views.MenuView"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
            xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
            xmlns:local="clr-namespace:RestaurantApp.Views"
            xmlns:converters="clr-namespace:RestaurantApp.Converters"
            mc:Ignorable="d" 
            d:DesignHeight="600" d:DesignWidth="1000">

   <UserControl.Resources>
       <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
       <converters:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter"/>
   </UserControl.Resources>

   <Grid Margin="20">
       <Grid.RowDefinitions>
           <RowDefinition Height="Auto"/>
           <RowDefinition Height="*"/>
       </Grid.RowDefinitions>

       <!-- Title -->
       <TextBlock Grid.Row="0"
                  Text="Restaurant Menu"
                  FontSize="24"
                  FontWeight="Bold"
                  Margin="0,0,0,20"/>

       <!-- Menu Content -->
       <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
           <ItemsControl ItemsSource="{Binding Categories}">
               <ItemsControl.ItemTemplate>
                   <DataTemplate>
                       <StackPanel Margin="0,0,0,30">
                           <!-- Category Header -->
                           <TextBlock Text="{Binding Name}"
                                      FontSize="20"
                                      FontWeight="SemiBold"
                                      Margin="0,0,0,10"/>

                           <!-- Products in Category -->
                           <ItemsControl ItemsSource="{Binding Products}">
                               <ItemsControl.ItemsPanel>
                                   <ItemsPanelTemplate>
                                       <WrapPanel/>
                                   </ItemsPanelTemplate>
                               </ItemsControl.ItemsPanel>
                               <ItemsControl.ItemTemplate>
                                   <DataTemplate>
                                       <Border BorderBrush="#FFE0E0E0"
                                               BorderThickness="1"
                                               CornerRadius="5"
                                               Width="300"
                                               Height="200"
                                               Margin="0,0,20,20"
                                               Padding="10">
                                           <Grid>
                                               <Grid.RowDefinitions>
                                                   <RowDefinition Height="Auto"/>
                                                   <RowDefinition Height="Auto"/>
                                                   <RowDefinition Height="Auto"/>
                                                   <RowDefinition Height="Auto"/>
                                                   <RowDefinition Height="*"/>
                                               </Grid.RowDefinitions>
                                               <Grid.ColumnDefinitions>
                                                   <ColumnDefinition Width="*"/>
                                                   <ColumnDefinition Width="Auto"/>
                                               </Grid.ColumnDefinitions>

                                               <!-- Product Name -->
                                               <TextBlock Grid.Row="0"
                                                          Grid.Column="0"
                                                          Text="{Binding Name}"
                                                          FontWeight="Bold"
                                                          FontSize="16"/>

                                               <!-- Product Price -->
                                               <TextBlock Grid.Row="0"
                                                          Grid.Column="1"
                                                          Text="{Binding Price, StringFormat={}{0:C}}"
                                                          FontWeight="Bold"
                                                          FontSize="16"
                                                          HorizontalAlignment="Right"/>

                                               <!-- Product Quantity -->
                                               <TextBlock Grid.Row="1"
                                                          Grid.Column="0"
                                                          Grid.ColumnSpan="2"
                                                          Text="{Binding PortionQuantity, StringFormat={}Portion: {0}g}"
                                                          Margin="0,5,0,0"/>

                                               <!-- Allergens -->
                                               <TextBlock Grid.Row="2"
                                                          Grid.Column="0"
                                                          Grid.ColumnSpan="2"
                                                          Text="Allergens:"
                                                          Margin="0,5,0,0"
                                                          Visibility="{Binding HasAllergens, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                                               <ItemsControl Grid.Row="3"
                                                             Grid.Column="0"
                                                             Grid.ColumnSpan="2"
                                                             ItemsSource="{Binding Allergens}"
                                                             Margin="5,0,0,0"
                                                             Visibility="{Binding HasAllergens, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                   <ItemsControl.ItemsPanel>
                                                       <ItemsPanelTemplate>
                                                           <WrapPanel/>
                                                       </ItemsPanelTemplate>
                                                   </ItemsControl.ItemsPanel>
                                                   <ItemsControl.ItemTemplate>
                                                       <DataTemplate>
                                                           <TextBlock Text="{Binding Name}" Margin="0,0,5,0"/>
                                                       </DataTemplate>
                                                   </ItemsControl.ItemTemplate>
                                               </ItemsControl>

                                               <!-- Availability Status -->
                                               <TextBlock Grid.Row="4"
                                                          Grid.Column="0"
                                                          Grid.ColumnSpan="2"
                                                          Text="INDISPONIBIL"
                                                          Foreground="Red"
                                                          FontWeight="Bold"
                                                          VerticalAlignment="Bottom"
                                                          HorizontalAlignment="Center"
                                                          Visibility="{Binding IsAvailable, Converter={StaticResource InverseBooleanToVisibilityConverter}}"/>

                                               <!-- Add to Order Button -->
                                               <Button Grid.Row="4"
                                                       Grid.Column="0"
                                                       Grid.ColumnSpan="2"
                                                       Content="Add to Order"
                                                       Command="{Binding DataContext.AddToOrderCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                       CommandParameter="{Binding}"
                                                       VerticalAlignment="Bottom"
                                                       HorizontalAlignment="Right"
                                                       Padding="8,5"
                                                       Background="#FF4CAF50"
                                                       Foreground="White"
                                                       BorderThickness="0"
                                                       Visibility="{Binding IsAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                           </Grid>
                                       </Border>
                                   </DataTemplate>
                               </ItemsControl.ItemTemplate>
                           </ItemsControl>

                           <!-- Menus in Category -->
                           <ItemsControl ItemsSource="{Binding Menus}">
                               <ItemsControl.ItemsPanel>
                                   <ItemsPanelTemplate>
                                       <WrapPanel/>
                                   </ItemsPanelTemplate>
                               </ItemsControl.ItemsPanel>
                               <ItemsControl.ItemTemplate>
                                   <DataTemplate>
                                       <Border BorderBrush="#FFE0E0E0"
                                               BorderThickness="1"
                                               CornerRadius="5"
                                               Width="300"
                                               Height="250"
                                               Margin="0,0,20,20"
                                               Padding="10"
                                               Background="#FFFFF8E1">
                                           <Grid>
                                               <Grid.RowDefinitions>
                                                   <RowDefinition Height="Auto"/>
                                                   <RowDefinition Height="Auto"/>
                                                   <RowDefinition Height="Auto"/>
                                                   <RowDefinition Height="*"/>
                                               </Grid.RowDefinitions>
                                               <Grid.ColumnDefinitions>
                                                   <ColumnDefinition Width="*"/>
                                                   <ColumnDefinition Width="Auto"/>
                                               </Grid.ColumnDefinitions>

                                               <!-- Menu Name -->
                                               <TextBlock Grid.Row="0"
                                                          Grid.Column="0"
                                                          Text="{Binding Name}"
                                                          FontWeight="Bold"
                                                          FontSize="16"/>

                                               <!-- Menu Price -->
                                               <TextBlock Grid.Row="0"
                                                          Grid.Column="1"
                                                          Text="{Binding Price, StringFormat={}{0:C}}"
                                                          FontWeight="Bold"
                                                          FontSize="16"
                                                          HorizontalAlignment="Right"/>

                                               <!-- Menu Products -->
                                               <TextBlock Grid.Row="1"
                                                          Grid.Column="0"
                                                          Grid.ColumnSpan="2"
                                                          Text="Includes:"
                                                          Margin="0,5,0,0"
                                                          FontWeight="SemiBold"/>

                                               <ItemsControl Grid.Row="2"
                                                             Grid.Column="0"
                                                             Grid.ColumnSpan="2"
                                                             ItemsSource="{Binding MenuProducts}"
                                                             Margin="5,0,0,0">
                                                   <ItemsControl.ItemTemplate>
                                                       <DataTemplate>
                                                           <TextBlock>
                                                               <Run Text="{Binding Product.Name}"/>
                                                               <Run Text=" ("/>
                                                               <Run Text="{Binding Quantity}"/>
                                                               <Run Text="g)"/>
                                                           </TextBlock>
                                                       </DataTemplate>
                                                   </ItemsControl.ItemTemplate>
                                               </ItemsControl>

                                               <!-- Availability Status -->
                                               <TextBlock Grid.Row="3"
                                                          Grid.Column="0"
                                                          Grid.ColumnSpan="2"
                                                          Text="INDISPONIBIL"
                                                          Foreground="Red"
                                                          FontWeight="Bold"
                                                          VerticalAlignment="Bottom"
                                                          HorizontalAlignment="Center"
                                                          Visibility="{Binding IsAvailable, Converter={StaticResource InverseBooleanToVisibilityConverter}}"/>

                                               <!-- Add to Order Button -->
                                               <Button Grid.Row="3"
                                                       Grid.Column="0"
                                                       Grid.ColumnSpan="2"
                                                       Content="Add to Order"
                                                       Command="{Binding DataContext.AddToOrderCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                       CommandParameter="{Binding}"
                                                       VerticalAlignment="Bottom"
                                                       HorizontalAlignment="Right"
                                                       Padding="8,5"
                                                       Background="#FF4CAF50"
                                                       Foreground="White"
                                                       BorderThickness="0"
                                                       Visibility="{Binding IsAvailable, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                           </Grid>
                                       </Border>
                                   </DataTemplate>
                               </ItemsControl.ItemTemplate>
                           </ItemsControl>
                       </StackPanel>
                   </DataTemplate>
               </ItemsControl.ItemTemplate>
           </ItemsControl>
       </ScrollViewer>
   </Grid>
</UserControl>

